import streamlit as st
import pandas as pd
import folium
from folium.plugins import MarkerCluster
from streamlit_folium import st_folium

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="ì„œìš¸ ì™¸êµ­ì¸ ì¸ê¸° ê´€ê´‘ì§€ Top 10", layout="wide")

st.title("ğŸ™ï¸ ì„œìš¸ ì™¸êµ­ì¸ ì¸ê¸° ê´€ê´‘ì§€ Top 10")
st.markdown("ì„œìš¸ì—ì„œ ì™¸êµ­ì¸ë“¤ì´ ê°€ì¥ ë§ì´ ë°©ë¬¸í•˜ê³  ì¢‹ì•„í•˜ëŠ” ê´€ê´‘ì§€ 10ê³³ì„ ì§€ë„ì— í‘œì‹œí–ˆìŠµë‹ˆë‹¤."
            " ë§ˆì»¤ë¥¼ í´ë¦­í•˜ë©´ ê°„ë‹¨í•œ ì„¤ëª…ê³¼ ê°€ê¹Œìš´ ì§€í•˜ì² ì—­ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.")

# ê´€ê´‘ì§€ ë°ì´í„°
places = [
    {"name": "ê²½ë³µê¶ (Gyeongbokgung Palace)", "lat": 37.579617, "lon": 126.977041, "category": "ê¶ê¶",
     "desc": "ì¡°ì„ ì‹œëŒ€ ëŒ€í‘œ ê¶ê¶ë¡œ, ê·¼ì •ì „ê³¼ ê²½íšŒë£¨ ë“± ì „í†µ ê±´ì¶•ë¯¸ê°€ ë›°ì–´ë‚˜ë©° í•œêµ­ì˜ ì—­ì‚¬ì™€ ë¬¸í™”ë¥¼ ìƒì§•í•©ë‹ˆë‹¤.",
     "subway": "ğŸš‡ ê²½ë³µê¶ì—­ (3í˜¸ì„ ) ë„ë³´ 5ë¶„"},
    {"name": "ì°½ë•ê¶ & í›„ì› (Changdeokgung & Huwon)", "lat": 37.579294, "lon": 126.991043, "category": "ê¶ê¶/ì •ì›",
     "desc": "ìœ ë„¤ìŠ¤ì½” ì„¸ê³„ë¬¸í™”ìœ ì‚°ìœ¼ë¡œ ì§€ì •ëœ ê¶ê¶ë¡œ, ìì—°ê³¼ ì¡°í™”ë¥¼ ì´ë£¨ëŠ” í›„ì›(ë¹„ì›)ìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤.",
     "subway": "ğŸš‡ ì•ˆêµ­ì—­ (3í˜¸ì„ ) ë„ë³´ 10ë¶„"},
    {"name": "ë¶ì´Œ í•œì˜¥ë§ˆì„ (Bukchon Hanok Village)", "lat": 37.582604, "lon": 126.983030, "category": "ì „í†µë§ˆì„",
     "desc": "ì „í†µ í•œì˜¥ì´ ëª¨ì—¬ ìˆì–´ í•œêµ­ ê³ ìœ ì˜ ê±´ì¶•ë¯¸ì™€ ìƒí™œ ë¬¸í™”ë¥¼ ëŠë‚„ ìˆ˜ ìˆëŠ” ëª…ì†Œì…ë‹ˆë‹¤.",
     "subway": "ğŸš‡ ì•ˆêµ­ì—­ (3í˜¸ì„ ) ë„ë³´ 5ë¶„"},
    {"name": "ì¸ì‚¬ë™ (Insadong)", "lat": 37.574372, "lon": 126.985029, "category": "ë¬¸í™”ê±°ë¦¬",
     "desc": "ì „í†µ ê³µì˜ˆí’ˆ, ê°¤ëŸ¬ë¦¬, ì°»ì§‘, ê¸°ë…í’ˆì  ë“±ì´ ëª¨ì—¬ ìˆì–´ ì „í†µê³¼ í˜„ëŒ€ê°€ ì¡°í™”ëœ ê±°ë¦¬ì…ë‹ˆë‹¤.",
     "subway": "ğŸš‡ ì¢…ê°ì—­ (1í˜¸ì„ ) ë„ë³´ 7ë¶„"},
    {"name": "ëª…ë™ (Myeongdong)", "lat": 37.560975, "lon": 126.986015, "category": "ì‡¼í•‘ê±°ë¦¬",
     "desc": "ì„œìš¸ì„ ëŒ€í‘œí•˜ëŠ” ì‡¼í•‘ê±°ë¦¬ë¡œ, íŒ¨ì…˜ ë¸Œëœë“œì™€ ê¸¸ê±°ë¦¬ ìŒì‹, í™”ì¥í’ˆ ì‡¼í•‘ì´ ì¸ê¸°ê°€ ë§ìŠµë‹ˆë‹¤.",
     "subway": "ğŸš‡ ëª…ë™ì—­ (4í˜¸ì„ ) ë„ë³´ 3ë¶„"},
    {"name": "Nì„œìš¸íƒ€ì›Œ (N Seoul Tower, Namsan)", "lat": 37.551169, "lon": 126.988227, "category": "ì „ë§/íƒ‘",
     "desc": "ì„œìš¸ì˜ ì „ê²½ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆëŠ” ì „ë§ ëª…ì†Œë¡œ, ì•¼ê²½ê³¼ ì‚¬ë‘ì˜ ìë¬¼ì‡  ëª…ì†Œë¡œ ìœ ëª…í•©ë‹ˆë‹¤.",
     "subway": "ğŸš‡ ëª…ë™ì—­ (4í˜¸ì„ ) â†’ ë‚¨ì‚° ì¼€ì´ë¸”ì¹´ ì´ìš©"},
    {"name": "í™ëŒ€ (Hongdae)", "lat": 37.556241, "lon": 126.923998, "category": "ì˜ˆìˆ /ê±°ë¦¬",
     "desc": "ì¸ë”” ìŒì•…, ê¸¸ê±°ë¦¬ ê³µì—°, íŠ¸ë Œë””í•œ ì¹´í˜ì™€ í´ëŸ½ì´ ëª¨ì—¬ ìˆëŠ” ì ŠìŒì˜ ê±°ë¦¬ì…ë‹ˆë‹¤.",
     "subway": "ğŸš‡ í™ëŒ€ì…êµ¬ì—­ (2í˜¸ì„ , ê³µí•­ì² ë„) ë„ë³´ 3ë¶„"},
    {"name": "ë™ëŒ€ë¬¸ë””ìì¸í”Œë¼ì (DDP)", "lat": 37.566324, "lon": 127.009210, "category": "ë””ìì¸/ì•¼ê²½",
     "desc": "ë¯¸ë˜ì ì¸ ê±´ì¶•ë¯¸ì™€ ë‹¤ì–‘í•œ ì „ì‹œ, íŒ¨ì…˜ ì´ë²¤íŠ¸ë¡œ ìœ ëª…í•œ ì„œìš¸ì˜ ë””ìì¸ ëœë“œë§ˆí¬ì…ë‹ˆë‹¤.",
     "subway": "ğŸš‡ ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›ì—­ (2Â·4Â·5í˜¸ì„ ) ë„ë³´ 2ë¶„"},
    {"name": "ë¡¯ë°ì›”ë“œíƒ€ì›Œ (Lotte World Tower)", "lat": 37.513068, "lon": 127.102539, "category": "ì‡¼í•‘/ì „ë§",
     "desc": "555m ë†’ì´ì˜ ì´ˆê³ ì¸µ ë¹Œë”©ìœ¼ë¡œ, ì „ë§ëŒ€ì™€ ì‡¼í•‘ëª°, ìˆ˜ì¡±ê´€, í˜¸í…”ì´ í•œ ê³³ì— ëª¨ì—¬ ìˆìŠµë‹ˆë‹¤.",
     "subway": "ğŸš‡ ì ì‹¤ì—­ (2Â·8í˜¸ì„ ) ë„ë³´ 2ë¶„"},
    {"name": "ì½”ì—‘ìŠ¤ & ë´‰ì€ì‚¬ (COEX & Bongeunsa)", "lat": 37.512091, "lon": 127.058567, "category": "ë¬¸í™”/ì‚¬ì°°",
     "desc": "ì„¸ê³„ì ì¸ ì»¨ë²¤ì…˜ì„¼í„° ì½”ì—‘ìŠ¤ì™€ ì „í†µ ì‚¬ì°° ë´‰ì€ì‚¬ê°€ ë‚˜ë€íˆ ìœ„ì¹˜í•´ ì „í†µê³¼ í˜„ëŒ€ê°€ ê³µì¡´í•©ë‹ˆë‹¤.",
     "subway": "ğŸš‡ ì‚¼ì„±ì—­ (2í˜¸ì„ ) ë„ë³´ 5ë¶„"}
]

df = pd.DataFrame(places)

# ì‚¬ì´ë“œë°” í•„í„°
st.sidebar.header("ğŸ” í•„í„°")
categories = ["All"] + sorted(df["category"].unique().tolist())
selected = st.sidebar.selectbox("ì¹´í…Œê³ ë¦¬ ì„ íƒ", categories)

df_display = df if selected == "All" else df[df["category"] == selected]

# ì§€ë„ ìƒì„±
m = folium.Map(location=[37.5665, 126.9780], zoom_start=12)

marker_cluster = MarkerCluster().add_to(m)

# Folium ê¸°ë³¸ ìƒ‰ìƒì— ë§ê²Œ ìˆ˜ì •
color_map = {
    "ê¶ê¶": "purple",
    "ê¶ê¶/ì •ì›": "darkpurple",
    "ì „í†µë§ˆì„": "green",
    "ë¬¸í™”ê±°ë¦¬": "blue",
    "ì‡¼í•‘ê±°ë¦¬": "cadetblue",
    "ì „ë§/íƒ‘": "red",
    "ì˜ˆìˆ /ê±°ë¦¬": "orange",
    "ë””ìì¸/ì•¼ê²½": "lightred",  # pink â†’ lightredë¡œ ìˆ˜ì •
    "ì‡¼í•‘/ì „ë§": "darkblue",
    "ë¬¸í™”/ì‚¬ì°°": "gray"
}

# ë§ˆì»¤ ì¶”ê°€
for _, r in df_display.iterrows():
    popup_html = f"""
    <div style="width:200px;">
    <b>{r['name']}</b><br>
    <i>{r['category']}</i><br>
    <p style="font-size:13px;">{r['desc']}</p>
    <p><b>{r['subway']}</b></p>
    </div>
    """
    folium.CircleMarker(
        location=[r["lat"], r["lon"]],
        radius=10,
        color=color_map.get(r["category"], "blue"),
        fill=True,
        fill_color=color_map.get(r["category"], "blue"),
        fill_opacity=0.8,
        popup=folium.Popup(popup_html, max_width=300),
        tooltip=r["name"]
    ).add_to(marker_cluster)

# ì§€ë„ í‘œì‹œ
st.subheader("ğŸ—ºï¸ ê´€ê´‘ì§€ë„")
st_folium(m, width="100%", height=650)

# ìƒì„¸ ì„¤ëª…
st.subheader("ğŸ“ ê´€ê´‘ì§€ë³„ ìƒì„¸ ì„¤ëª…")
for i, row in df_display.iterrows():
    st.markdown(f"### {i+1}. {row['name']}")
    st.write(f"**ì¹´í…Œê³ ë¦¬:** {row['category']}")
    st.write(f"**ê°€ê¹Œìš´ ì§€í•˜ì² ì—­:** {row['subway']}")
    st.write(f"**ì™œ ìœ ëª…í• ê¹Œìš”?** {row['desc']}")
    st.markdown("---")

# ë°ì´í„° í…Œì´ë¸”
st.subheader("ğŸ“‹ ê´€ê´‘ì§€ ë°ì´í„° ìš”ì•½")
st.dataframe(
    df_display[["name", "category", "lat", "lon", "subway"]]
    .rename(columns={"name": "ì´ë¦„", "category": "ì¹´í…Œê³ ë¦¬", "lat": "ìœ„ë„", "lon": "ê²½ë„", "subway": "ê°€ê¹Œìš´ ì§€í•˜ì² "}),
    use_container_width=True
)

st.caption("ë°ì´í„°ëŠ” ì˜ˆì‹œì´ë©° ì‹¤ì œ ê±°ë¦¬ë‚˜ ì‹œê°„ì€ ì•½ê°„ì˜ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
